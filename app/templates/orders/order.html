{% extends "base.html" %}
{% block title %}ã‚ªãƒ¼ãƒ€ãƒ¼è©³ç´°{% endblock %}

{% block content %}
  <h2>æ¥é™¢ ID {{ order.visit_id }} ã®ã‚ªãƒ¼ãƒ€ãƒ¼</h2>

  <p>
    æ”¯æ‰•çŠ¶æ³: <strong>{{ order.payment_status }}</strong>
    <a href="{{ url_for('orders.toggle_payment', order_id=order.id) }}" class="btn btn-sm btn-outline-primary ms-2">
      åˆ‡æ›¿
    </a>
  </p>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>ID</th>
        <th>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</th>
        <th>æ•°é‡</th>
        <th>å°è¨ˆ</th>
        <th>æ“ä½œ</th>
      </tr>
    </thead>
    <tbody>
      {% for it in order.items %}
      <tr>
        <td>{{ it.id }}</td>
        <td>{{ it.treatment.name }}</td>
        <td>{{ it.quantity }}</td>
        <td>Â¥{{ it.subtotal }}</td>
        <td>
          <a href="{{ url_for('orders.edit_item', item_id=it.id) }}" class="btn btn-sm btn-warning">ç·¨é›†</a>
          <a href="{{ url_for('orders.delete_item', item_id=it.id) }}" class="btn btn-sm btn-danger ms-1">å‰Šé™¤</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h3 class="mt-3">åˆè¨ˆ: Â¥{{ order.total_amount }}</h3>

  <p>
    <a href="{{ url_for('orders.invoice', order_id=order.id) }}" target="_blank" class="btn btn-outline-secondary mt-2">
      ğŸ“„ æ˜ç´°æ›¸ã‚’è¡¨ç¤º / å°åˆ·
    </a>
  </p>

  <hr>

  <h3>æ˜ç´°ã‚’è¿½åŠ </h3>
  <form method="post" class="mb-3">
    {{ form.hidden_tag() }}
    <div class="mb-2">
      {{ form.treatment_id.label(class="form-label") }}
      {{ form.treatment_id(class="form-select d-inline-block w-auto") }}
    </div>
    <div class="mb-2">
      {{ form.quantity.label(class="form-label") }}
      {{ form.quantity(class="form-control d-inline-block w-auto", min="1") }}
    </div>
    <button type="submit" class="btn btn-primary">{{ form.submit.label.text }}</button>
  </form>

  <p>
    <a href="{{ url_for('visits.list_visits', d=order.visit.visit_date) }}" class="btn btn-link">
      â† æ¥é™¢ä¸€è¦§ã¸æˆ»ã‚‹
    </a>
  </p>
{% endblock %}
